create or replace database GEO_CHALLENGE;
create or replace schema  dbt;
create or replace schema input;
create or replace schema notebook;
create or replace schema geo_challenge.agents;
create or replace stage geo_challenge.input.test;
create or replace stage geo_challenge.input.train;

create or replace TABLE GEO_CHALLENGE.INPUT.TEST (
	ID VARCHAR(16777216),
	TARGET_YM VARCHAR(16777216),
	BUILDING_ID VARCHAR(16777216),
	BUILDING_STATUS VARCHAR(16777216),
	BUILDING_CREATE_DATE TIMESTAMP_NTZ(9),
	BUILDING_MODIFY_DATE TIMESTAMP_NTZ(9),
	BUILDING_TYPE NUMBER(38,0),
	BUILDING_NAME VARCHAR(16777216),
	BUILDING_NAME_RUBY VARCHAR(16777216),
	HOMES_BUILDING_NAME VARCHAR(16777216),
	HOMES_BUILDING_NAME_RUBY VARCHAR(16777216),
	UNIT_COUNT NUMBER(38,0),
	FULL_ADDRESS VARCHAR(16777216),
	LON NUMBER(38,7),
	LAT NUMBER(38,7),
	BUILDING_STRUCTURE NUMBER(38,0),
	TOTAL_FLOOR_AREA NUMBER(38,7),
	BUILDING_AREA NUMBER(38,7),
	FLOOR_COUNT NUMBER(38,0),
	BASEMENT_FLOOR_COUNT NUMBER(38,0),
	YEAR_BUILT NUMBER(38,0),
	BUILDING_LAND_AREA NUMBER(38,7),
	LAND_AREA_ALL NUMBER(38,7),
	UNIT_AREA_MIN NUMBER(38,7),
	UNIT_AREA_MAX NUMBER(38,7),
	BUILDING_LAND_CHIMOKU NUMBER(38,0),
	LAND_YOUTO NUMBER(38,0),
	LAND_TOSHI NUMBER(38,0),
	LAND_CHISEI NUMBER(38,0),
	LAND_AREA_KIND NUMBER(38,0),
	LAND_SETBACK_FLG NUMBER(38,0),
	LAND_SETBACK VARCHAR(16777216),
	LAND_KENPEI NUMBER(38,1),
	LAND_YOUSEKI NUMBER(38,1),
	LAND_ROAD_COND NUMBER(38,1),
	LAND_SEIGEN VARCHAR(16777216),
	BUILDING_AREA_KIND NUMBER(38,0),
	MANAGEMENT_FORM NUMBER(38,0),
	MANAGEMENT_ASSOCIATION_FLG NUMBER(38,0),
	REFORM_EXTERIOR VARCHAR(16777216),
	REFORM_EXTERIOR_OTHER VARCHAR(16777216),
	REFORM_EXTERIOR_DATE NUMBER(38,0),
	REFORM_COMMON_AREA VARCHAR(16777216),
	REFORM_COMMON_AREA_DATE NUMBER(38,0),
	BUILDING_TAG_ID VARCHAR(16777216),
	UNIT_ID NUMBER(38,0),
	UNIT_NAME VARCHAR(16777216),
	NAME_RUBY VARCHAR(16777216),
	ROOM_FLOOR NUMBER(38,0),
	BALCONY_AREA NUMBER(38,9),
	DWELLING_UNIT_WINDOW_ANGLE NUMBER(38,0),
	ROOM_COUNT NUMBER(38,0),
	UNIT_AREA NUMBER(38,8),
	FLOOR_PLAN_CODE NUMBER(38,0),
	REFORM_DATE NUMBER(38,0),
	REFORM_PLACE VARCHAR(16777216),
	REFORM_PLACE_OTHER VARCHAR(16777216),
	REFORM_WET_AREA VARCHAR(16777216),
	REFORM_WET_AREA_OTHER VARCHAR(16777216),
	REFORM_WET_AREA_DATE NUMBER(38,0),
	REFORM_INTERIOR VARCHAR(16777216),
	REFORM_INTERIOR_OTHER VARCHAR(16777216),
	REFORM_INTERIOR_DATE NUMBER(38,0),
	REFORM_ETC VARCHAR(16777216),
	RENOVATION_DATE DATE,
	RENOVATION_ETC VARCHAR(16777216),
	UNIT_TAG_ID VARCHAR(16777216),
	BUKKEN_ID NUMBER(38,0),
	SNAPSHOT_CREATE_DATE TIMESTAMP_NTZ(9),
	NEW_DATE TIMESTAMP_NTZ(9),
	SNAPSHOT_MODIFY_DATE TIMESTAMP_NTZ(9),
	TIMELIMIT_DATE TIMESTAMP_NTZ(9),
	BUKKEN_TYPE NUMBER(38,0),
	FLG_INVESTMENT NUMBER(38,0),
	EMPTY_NUMBER NUMBER(38,0),
	EMPTY_CONTENTS VARCHAR(16777216),
	POST1 NUMBER(38,0),
	POST2 NUMBER(38,0),
	ADDR1_1 NUMBER(38,0),
	ADDR1_2 NUMBER(38,0),
	ADDR2_NAME VARCHAR(16777216),
	ADDR3_NAME VARCHAR(16777216),
	NL NUMBER(38,0),
	EL NUMBER(38,0),
	ROSEN_NAME1 VARCHAR(16777216),
	EKI_NAME1 VARCHAR(16777216),
	BUS_STOP1 VARCHAR(16777216),
	BUS_TIME1 NUMBER(38,0),
	WALK_DISTANCE1 NUMBER(38,0),
	ROSEN_NAME2 VARCHAR(16777216),
	EKI_NAME2 VARCHAR(16777216),
	BUS_STOP2 VARCHAR(16777216),
	BUS_TIME2 NUMBER(38,0),
	WALK_DISTANCE2 NUMBER(38,0),
	TRAFFIC_OTHER VARCHAR(16777216),
	TRAFFIC_CAR VARCHAR(16777216),
	SNAPSHOT_LAND_AREA NUMBER(38,0),
	SNAPSHOT_LAND_SHIDOU NUMBER(38,0),
	LAND_SHIDOU_A NUMBER(38,0),
	LAND_SHIDOU_B NUMBER(38,0),
	LAND_MOCHIBUN_A NUMBER(38,0),
	LAND_MOCHIBUN_B NUMBER(38,0),
	HOUSE_AREA NUMBER(38,0),
	FLG_NEW NUMBER(38,0),
	HOUSE_KANRININ NUMBER(38,0),
	ROOM_KAISUU NUMBER(38,0),
	SNAPSHOT_WINDOW_ANGLE NUMBER(38,0),
	MADORI_NUMBER_ALL NUMBER(38,0),
	MADORI_KIND_ALL NUMBER(38,0),
	MONEY_KYOUEKI NUMBER(38,0),
	MONEY_KYOUEKI_TAX NUMBER(38,0),
	MONEY_RIMAWARI_NOW NUMBER(38,0),
	MONEY_SHUUZEN NUMBER(38,0),
	MONEY_SHUUZENKIKIN NUMBER(38,0),
	MONEY_SONOTA_STR1 VARCHAR(16777216),
	MONEY_SONOTA1 NUMBER(38,0),
	MONEY_SONOTA_STR2 VARCHAR(16777216),
	MONEY_SONOTA2 NUMBER(38,0),
	MONEY_SONOTA_STR3 VARCHAR(16777216),
	MONEY_SONOTA3 NUMBER(38,0),
	PARKING_MONEY NUMBER(38,0),
	PARKING_MONEY_TAX NUMBER(38,0),
	PARKING_KUBUN NUMBER(38,0),
	PARKING_DISTANCE NUMBER(38,0),
	PARKING_NUMBER NUMBER(38,0),
	PARKING_MEMO VARCHAR(16777216),
	GENKYO_CODE NUMBER(38,0),
	USABLE_STATUS NUMBER(38,0),
	USABLE_DATE NUMBER(38,0),
	SCHOOL_ELE_NAME VARCHAR(16777216),
	SCHOOL_ELE_DISTANCE NUMBER(38,0),
	SCHOOL_ELE_CODE VARCHAR(16777216),
	SCHOOL_JUN_NAME VARCHAR(16777216),
	SCHOOL_JUN_DISTANCE NUMBER(38,0),
	SCHOOL_JUN_CODE VARCHAR(16777216),
	CONVENIENCE_DISTANCE NUMBER(38,0),
	SUPER_DISTANCE NUMBER(38,0),
	HOSPITAL_DISTANCE NUMBER(38,0),
	PARK_DISTANCE NUMBER(38,0),
	DRUGSTORE_DISTANCE NUMBER(38,0),
	BANK_DISTANCE NUMBER(38,0),
	SHOPPING_STREET_DISTANCE NUMBER(38,0),
	EST_OTHER_NAME VARCHAR(16777216),
	EST_OTHER_DISTANCE NUMBER(38,0),
	STATUSES VARCHAR(16777216),
	PARKING_KEIYAKU NUMBER(38,0),
	MONEY_HOSHOU_COMPANY VARCHAR(16777216),
	FREE_RENT_DURATION VARCHAR(16777216),
	FREE_RENT_GEN_TIMING VARCHAR(16777216)
);

create or replace TABLE GEO_CHALLENGE.INPUT.TRAIN (
	TARGET_YM VARCHAR(16777216),
	MONEY_ROOM NUMBER(38,0),
	BUILDING_ID VARCHAR(16777216),
	BUILDING_STATUS VARCHAR(16777216),
	BUILDING_CREATE_DATE TIMESTAMP_NTZ(9),
	BUILDING_MODIFY_DATE TIMESTAMP_NTZ(9),
	BUILDING_TYPE NUMBER(38,0),
	BUILDING_NAME VARCHAR(16777216),
	BUILDING_NAME_RUBY VARCHAR(16777216),
	HOMES_BUILDING_NAME VARCHAR(16777216),
	HOMES_BUILDING_NAME_RUBY VARCHAR(16777216),
	UNIT_COUNT NUMBER(38,0),
	FULL_ADDRESS VARCHAR(16777216),
	LON NUMBER(38,7),
	LAT NUMBER(38,7),
	BUILDING_STRUCTURE NUMBER(38,0),
	TOTAL_FLOOR_AREA NUMBER(38,7),
	BUILDING_AREA NUMBER(38,7),
	FLOOR_COUNT NUMBER(38,0),
	BASEMENT_FLOOR_COUNT NUMBER(38,0),
	YEAR_BUILT NUMBER(38,0),
	BUILDING_LAND_AREA NUMBER(38,7),
	LAND_AREA_ALL NUMBER(38,7),
	UNIT_AREA_MIN NUMBER(38,7),
	UNIT_AREA_MAX NUMBER(38,7),
	BUILDING_LAND_CHIMOKU NUMBER(38,0),
	LAND_YOUTO NUMBER(38,0),
	LAND_TOSHI NUMBER(38,0),
	LAND_CHISEI NUMBER(38,0),
	LAND_AREA_KIND NUMBER(38,0),
	LAND_SETBACK_FLG NUMBER(38,0),
	LAND_SETBACK NUMBER(38,2),
	LAND_KENPEI NUMBER(38,1),
	LAND_YOUSEKI NUMBER(38,1),
	LAND_ROAD_COND NUMBER(38,0),
	LAND_SEIGEN VARCHAR(16777216),
	BUILDING_AREA_KIND NUMBER(38,0),
	MANAGEMENT_FORM NUMBER(38,0),
	MANAGEMENT_ASSOCIATION_FLG NUMBER(38,0),
	REFORM_EXTERIOR VARCHAR(16777216),
	REFORM_EXTERIOR_OTHER VARCHAR(16777216),
	REFORM_EXTERIOR_DATE NUMBER(38,0),
	REFORM_COMMON_AREA VARCHAR(16777216),
	REFORM_COMMON_AREA_DATE NUMBER(38,0),
	BUILDING_TAG_ID VARCHAR(16777216),
	UNIT_ID NUMBER(38,0),
	UNIT_NAME VARCHAR(16777216),
	NAME_RUBY VARCHAR(16777216),
	ROOM_FLOOR NUMBER(38,0),
	BALCONY_AREA NUMBER(38,9),
	DWELLING_UNIT_WINDOW_ANGLE NUMBER(38,0),
	ROOM_COUNT NUMBER(38,0),
	UNIT_AREA NUMBER(38,8),
	FLOOR_PLAN_CODE NUMBER(38,0),
	REFORM_DATE NUMBER(38,0),
	REFORM_PLACE VARCHAR(16777216),
	REFORM_PLACE_OTHER VARCHAR(16777216),
	REFORM_WET_AREA VARCHAR(16777216),
	REFORM_WET_AREA_OTHER VARCHAR(16777216),
	REFORM_WET_AREA_DATE NUMBER(38,0),
	REFORM_INTERIOR VARCHAR(16777216),
	REFORM_INTERIOR_OTHER VARCHAR(16777216),
	REFORM_INTERIOR_DATE NUMBER(38,0),
	REFORM_ETC VARCHAR(16777216),
	RENOVATION_DATE DATE,
	RENOVATION_ETC VARCHAR(16777216),
	UNIT_TAG_ID VARCHAR(16777216),
	BUKKEN_ID NUMBER(38,0),
	SNAPSHOT_CREATE_DATE TIMESTAMP_NTZ(9),
	NEW_DATE TIMESTAMP_NTZ(9),
	SNAPSHOT_MODIFY_DATE TIMESTAMP_NTZ(9),
	TIMELIMIT_DATE TIMESTAMP_NTZ(9),
	BUKKEN_TYPE NUMBER(38,0),
	FLG_INVESTMENT NUMBER(38,0),
	EMPTY_NUMBER NUMBER(38,0),
	EMPTY_CONTENTS VARCHAR(16777216),
	POST1 NUMBER(38,0),
	POST2 NUMBER(38,0),
	ADDR1_1 NUMBER(38,0),
	ADDR1_2 NUMBER(38,0),
	ADDR2_NAME VARCHAR(16777216),
	ADDR3_NAME VARCHAR(16777216),
	NL NUMBER(38,0),
	EL NUMBER(38,0),
	ROSEN_NAME1 VARCHAR(16777216),
	EKI_NAME1 VARCHAR(16777216),
	BUS_STOP1 VARCHAR(16777216),
	BUS_TIME1 NUMBER(38,0),
	WALK_DISTANCE1 NUMBER(38,0),
	ROSEN_NAME2 VARCHAR(16777216),
	EKI_NAME2 VARCHAR(16777216),
	BUS_STOP2 VARCHAR(16777216),
	BUS_TIME2 NUMBER(38,0),
	WALK_DISTANCE2 NUMBER(38,0),
	TRAFFIC_OTHER VARCHAR(16777216),
	TRAFFIC_CAR VARCHAR(16777216),
	SNAPSHOT_LAND_AREA NUMBER(38,2),
	SNAPSHOT_LAND_SHIDOU NUMBER(38,2),
	LAND_SHIDOU_A NUMBER(38,0),
	LAND_SHIDOU_B NUMBER(38,0),
	LAND_MOCHIBUN_A NUMBER(38,0),
	LAND_MOCHIBUN_B NUMBER(38,0),
	HOUSE_AREA NUMBER(38,2),
	FLG_NEW NUMBER(38,0),
	HOUSE_KANRININ NUMBER(38,0),
	ROOM_KAISUU NUMBER(38,0),
	SNAPSHOT_WINDOW_ANGLE NUMBER(38,0),
	MADORI_NUMBER_ALL NUMBER(38,0),
	MADORI_KIND_ALL NUMBER(38,0),
	MONEY_KYOUEKI NUMBER(38,0),
	MONEY_KYOUEKI_TAX NUMBER(38,0),
	MONEY_RIMAWARI_NOW NUMBER(38,2),
	MONEY_SHUUZEN NUMBER(38,0),
	MONEY_SHUUZENKIKIN NUMBER(38,0),
	MONEY_SONOTA_STR1 VARCHAR(16777216),
	MONEY_SONOTA1 NUMBER(38,0),
	MONEY_SONOTA_STR2 VARCHAR(16777216),
	MONEY_SONOTA2 NUMBER(38,0),
	MONEY_SONOTA_STR3 VARCHAR(16777216),
	MONEY_SONOTA3 NUMBER(38,0),
	PARKING_MONEY NUMBER(38,0),
	PARKING_MONEY_TAX NUMBER(38,0),
	PARKING_KUBUN NUMBER(38,0),
	PARKING_DISTANCE NUMBER(38,0),
	PARKING_NUMBER NUMBER(38,0),
	PARKING_MEMO VARCHAR(16777216),
	GENKYO_CODE NUMBER(38,0),
	USABLE_STATUS NUMBER(38,0),
	USABLE_DATE NUMBER(38,0),
	SCHOOL_ELE_NAME VARCHAR(16777216),
	SCHOOL_ELE_DISTANCE NUMBER(38,0),
	SCHOOL_ELE_CODE VARCHAR(16777216),
	SCHOOL_JUN_NAME VARCHAR(16777216),
	SCHOOL_JUN_DISTANCE NUMBER(38,0),
	SCHOOL_JUN_CODE VARCHAR(16777216),
	CONVENIENCE_DISTANCE NUMBER(38,0),
	SUPER_DISTANCE NUMBER(38,0),
	HOSPITAL_DISTANCE NUMBER(38,0),
	PARK_DISTANCE NUMBER(38,0),
	DRUGSTORE_DISTANCE NUMBER(38,0),
	BANK_DISTANCE NUMBER(38,0),
	SHOPPING_STREET_DISTANCE NUMBER(38,0),
	EST_OTHER_NAME VARCHAR(16777216),
	EST_OTHER_DISTANCE NUMBER(38,0),
	STATUSES VARCHAR(16777216),
	PARKING_KEIYAKU NUMBER(38,0),
	MONEY_HOSHOU_COMPANY VARCHAR(16777216),
	FREE_RENT_DURATION VARCHAR(16777216),
	FREE_RENT_GEN_TIMING VARCHAR(16777216)
);

ALTER ACCOUNT SET CORTEX_ENABLED_CROSS_REGION = 'ANY_REGION';